import{c as i}from"./p-25433d0f.js";import{g as o}from"./p-d5a52441.js";import{i as d,a as l}from"./p-a3ae8411.js";import{s as n}from"./p-09484d0e.js";const v=i=>{const o=new CustomEvent("scProductViewed",{detail:{id:null==i?void 0:i.id,name:null==i?void 0:i.name,permalink:null==i?void 0:i.permalink,prices:null==i?void 0:i.prices},bubbles:!0});document.dispatchEvent(o)};var u,t,e,s,a,r,c,w,p,f,m,_,b,h;const O=(null===(t=null===(u=null===window||void 0===window?void 0:window.scData)||void 0===u?void 0:u.product_data)||void 0===t?void 0:t.product)||null,j=(null===(e=null==O?void 0:O.prices)||void 0===e?void 0:e.data)||[],V=(null===(s=null==O?void 0:O.variant_options)||void 0===s?void 0:s.data)||[],g=((null===(a=null==O?void 0:O.variants)||void 0===a?void 0:a.data)||[]).sort(((i,o)=>(null==i?void 0:i.position)-(null==o?void 0:o.position))),k=(j||[]).sort(((i,o)=>(null==i?void 0:i.position)-(null==o?void 0:o.position))).find((i=>!(null==i?void 0:i.archived))),y=(null==g?void 0:g.length)?g.find((i=>!((null==O?void 0:O.stock_enabled)&&!(null==O?void 0:O.allow_out_of_stock_purchases))||(null==i?void 0:i.available_stock)>0)):null,P=(null==k?void 0:k.amount)||null;O&&v(O);const S=i({formId:null===(w=null===(c=null===(r=null===window||void 0===window?void 0:window.scData)||void 0===r?void 0:r.product_data)||void 0===c?void 0:c.form)||void 0===w?void 0:w.ID,mode:(null===(f=null===(p=null===window||void 0===window?void 0:window.scData)||void 0===p?void 0:p.product_data)||void 0===f?void 0:f.mode)||"live",product:O,prices:j,variant_options:V,variants:g,quantity:1,selectedPrice:k,total:null,dialog:null,busy:!1,disabled:(null==k?void 0:k.archived)||(null==O?void 0:O.archived),adHocAmount:P,error:null,checkoutUrl:null===(_=null===(m=null===window||void 0===window?void 0:window.scData)||void 0===m?void 0:m.product_data)||void 0===_?void 0:_.checkout_link,line_item:{price_id:null==k?void 0:k.id,quantity:1,...(null==k?void 0:k.ad_hoc)?{ad_hoc_amount:P}:{},variant:(null==g?void 0:g.length)?null===(b=g[0])||void 0===b?void 0:b.id:null},selectedVariant:y,variantValues:{...(null==y?void 0:y.option_1)?{option_1:null==y?void 0:y.option_1}:{},...(null==y?void 0:y.option_2)?{option_2:null==y?void 0:y.option_2}:{},...(null==y?void 0:y.option_3)?{option_3:null==y?void 0:y.option_3}:{}}},((i,o)=>JSON.stringify(i)!==JSON.stringify(o))),{state:q,onChange:C,on:N,dispose:A,forceUpdate:H}=S;var J,M;(null===(h=null===window||void 0===window?void 0:window.sc)||void 0===h?void 0:h.store)&&(window.sc.store.product=S);const T=()=>(q.prices||[]).filter((i=>!(null==i?void 0:i.archived))).sort(((i,o)=>(null==i?void 0:i.position)-(null==o?void 0:o.position))),U=!(!(null===(J=q.product)||void 0===J?void 0:J.stock_enabled)||(null===(M=q.product)||void 0===M?void 0:M.allow_out_of_stock_purchases)),x=(i,o)=>d(i,o,q.variantValues,q.product),B=(i,o)=>l(i,o,q.variantValues,q.product),E=()=>{var i,o;return!!U&&((null==q?void 0:q.selectedVariant)?(null===(o=q.selectedVariant)||void 0===o?void 0:o.available_stock)<=0:(null===(i=q.product)||void 0===i?void 0:i.available_stock)<=0)},I=()=>{var i,l;return!!(null===(i=q.variants)||void 0===i?void 0:i.length)&&void 0===(null===(l=o({variants:q.variants,values:q.variantValues}))||void 0===l?void 0:l.id)},z=Object.freeze({__proto__:null,availablePrices:T,isStockNeedsToBeChecked:U,isOptionSoldOut:x,isOptionMissing:B,isProductOutOfStock:E,isSelectedVariantMissing:I});C("selectedPrice",(i=>{var o;q.total=q.adHocAmount||(null==i?void 0:i.amount)||0,q.adHocAmount=null==i?void 0:i.amount,q.disabled=(null==i?void 0:i.archived)||(null===(o=q.product)||void 0===o?void 0:o.archived)})),C("variantValues",(i=>{const l=o({variants:q.variants,values:i});l&&(q.selectedVariant=l)})),C("selectedVariant",(()=>{q.selectedVariant&&U&&(null==q?void 0:q.selectedVariant.available_stock)<(null==q?void 0:q.quantity)&&(q.quantity=(null==q?void 0:q.selectedVariant.available_stock)||1,n(wp.i18n.sprintf(wp.i18n.__("There are just %d items left in stock, and the quantity has been adjusted to %d.","surecart"),q.quantity,q.quantity),"assertive"))})),C("selectedPrice",(()=>D())),C("selectedVariant",(()=>D())),C("adHocAmount",(()=>D())),C("quantity",(()=>D()));const D=()=>{var i,o,l,d;q.line_item={price_id:null===(i=q.selectedPrice)||void 0===i?void 0:i.id,quantity:(null===(o=q.selectedPrice)||void 0===o?void 0:o.ad_hoc)?1:q.quantity,...(null===(l=q.selectedPrice)||void 0===l?void 0:l.ad_hoc)?{ad_hoc_amount:q.adHocAmount}:{},variant:null===(d=q.selectedVariant)||void 0===d?void 0:d.id}};export{N as a,I as b,x as c,A as d,B as e,H as f,z as g,T as h,E as i,C as o,q as s};