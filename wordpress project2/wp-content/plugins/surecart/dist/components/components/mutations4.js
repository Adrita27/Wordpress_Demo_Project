import{g as addLineItem}from"./index4.js";import{s as state}from"./watchers.js";import{g as getCheckout,s as setCheckout}from"./google.js";import{t as toggleCart}from"./ui.js";import{a as addQueryArgs}from"./add-query-args.js";const submitCartForm=async()=>{var t,e,a,o,d,i;if(!(null===(t=state.selectedPrice)||void 0===t?void 0:t.id))return;if((null===(e=state.selectedPrice)||void 0===e?void 0:e.ad_hoc)&&(null===state.adHocAmount||void 0===state.adHocAmount))return;const s=getCheckout(null==state?void 0:state.formId,state.mode);try{state.busy=!0;const t=await addLineItem({checkout:s,data:{price:null===(a=state.selectedPrice)||void 0===a?void 0:a.id,quantity:Math.max((null===(o=state.selectedPrice)||void 0===o?void 0:o.ad_hoc)?1:state.quantity,1),variant:null===(d=state.selectedVariant)||void 0===d?void 0:d.id,...(null===(i=state.selectedPrice)||void 0===i?void 0:i.ad_hoc)?{ad_hoc_amount:state.adHocAmount}:{}},live_mode:"test"!==state.mode});setCheckout(t,state.formId),toggleCart(!0),state.dialog=null}catch(t){console.error(t),state.error=t}finally{state.busy=!1}},getProductBuyLink=(t,e={})=>{var a,o,d,i,s,r,c;if((null===(a=state.selectedPrice)||void 0===a?void 0:a.id)&&(!(null===(o=state.selectedPrice)||void 0===o?void 0:o.ad_hoc)||state.adHocAmount))return addQueryArgs(t,{line_items:[{price:null===(d=state.selectedPrice)||void 0===d?void 0:d.id,quantity:(null===(i=state.selectedPrice)||void 0===i?void 0:i.ad_hoc)?1:state.quantity,...(null===(s=state.selectedPrice)||void 0===s?void 0:s.ad_hoc)?{ad_hoc_amount:state.adHocAmount}:{},...(null===(r=state.selectedVariant)||void 0===r?void 0:r.id)?{variant:null===(c=state.selectedVariant)||void 0===c?void 0:c.id}:{}}],...e})};export{getProductBuyLink as g,submitCartForm as s};