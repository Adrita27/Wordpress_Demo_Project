{"version":3,"file":"mutations.js","sourceRoot":"","sources":["../../../src/store/product/mutations.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,WAAW,EAAE,MAAM,wBAAwB,CAAC;AACrD,OAAO,KAAK,MAAM,SAAS,CAAC;AAC5B,OAAO,EAAE,WAAW,EAAE,WAAW,EAAE,MAAM,4BAA4B,CAAC;AAEtE,OAAO,EAAE,UAAU,EAAE,MAAM,WAAW,CAAC;AACvC,OAAO,EAAE,YAAY,EAAE,MAAM,gBAAgB,CAAC;AAE9C,MAAM,CAAC,MAAM,cAAc,GAAG,KAAK,IAAI,EAAE;;EACvC,IAAI,CAAC,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,EAAE,CAAA;IAAE,OAAO;EACrC,IAAI,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,MAAM,KAAI,CAAC,IAAI,KAAK,KAAK,CAAC,WAAW,IAAI,SAAS,KAAK,KAAK,CAAC,WAAW,CAAC;IAAE,OAAO;EAC3G,MAAM,aAAa,GAAG,WAAW,CAAC,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;EAC7D,IAAI;IACF,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;IAClB,MAAM,QAAQ,GAAG,MAAM,WAAW,CAAC;MACjC,QAAQ,EAAE,aAAa;MACvB,IAAI,EAAE;QACJ,KAAK,EAAE,MAAA,KAAK,CAAC,aAAa,0CAAE,EAAE;QAC9B,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,MAAM,EAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;QACvE,OAAO,EAAE,MAAA,KAAK,CAAC,eAAe,0CAAE,EAAE;QAClC,GAAG,CAAC,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,MAAM,EAAC,CAAC,CAAC,EAAE,aAAa,EAAE,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;OAC7E;MACD,SAAS,EAAE,KAAK,CAAC,IAAI,KAAK,MAAM;KACjC,CAAC,CAAC;IACH,WAAW,CAAC,QAAoB,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;IAChD,UAAU,CAAC,IAAI,CAAC,CAAC;IACjB,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;GACrB;EAAC,OAAO,CAAC,EAAE;IACV,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACjB,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC;GACjB;UAAS;IACR,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;GACpB;AACH,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAAC,GAAG,EAAE,KAAK,GAAG,EAAE,EAAE,EAAE;;EACnD,IAAI,CAAC,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,EAAE,CAAA;IAAE,OAAO;EACrC,IAAI,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,MAAM,KAAI,CAAC,KAAK,CAAC,WAAW;IAAE,OAAO;EAE9D,OAAO,YAAY,CAAC,GAAG,EAAE;IACvB,UAAU,EAAE;MACV;QACE,KAAK,EAAE,MAAA,KAAK,CAAC,aAAa,0CAAE,EAAE;QAC9B,QAAQ,EAAE,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,MAAM,EAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ;QAC1D,GAAG,CAAC,CAAA,MAAA,KAAK,CAAC,aAAa,0CAAE,MAAM,EAAC,CAAC,CAAC,EAAE,aAAa,EAAE,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QAC5E,GAAG,CAAC,CAAA,MAAA,KAAK,CAAC,eAAe,0CAAE,EAAE,EAAC,CAAC,CAAC,EAAE,OAAO,EAAE,MAAA,KAAK,CAAC,eAAe,0CAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;OAC7E;KACF;IACD,GAAG,KAAK;GACT,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import { addLineItem } from '../../services/session';\nimport state from './store';\nimport { getCheckout, setCheckout } from '@store/checkouts/mutations';\nimport { Checkout } from 'src/types';\nimport { toggleCart } from '@store/ui';\nimport { addQueryArgs } from '@wordpress/url';\n\nexport const submitCartForm = async () => {\n  if (!state.selectedPrice?.id) return;\n  if (state.selectedPrice?.ad_hoc && (null === state.adHocAmount || undefined === state.adHocAmount)) return;\n  const savedCheckout = getCheckout(state?.formId, state.mode);\n  try {\n    state.busy = true;\n    const checkout = await addLineItem({\n      checkout: savedCheckout,\n      data: {\n        price: state.selectedPrice?.id,\n        quantity: Math.max(state.selectedPrice?.ad_hoc ? 1 : state.quantity, 1),\n        variant: state.selectedVariant?.id,\n        ...(state.selectedPrice?.ad_hoc ? { ad_hoc_amount: state.adHocAmount } : {}),\n      },\n      live_mode: state.mode !== 'test',\n    });\n    setCheckout(checkout as Checkout, state.formId);\n    toggleCart(true);\n    state.dialog = null;\n  } catch (e) {\n    console.error(e);\n    state.error = e;\n  } finally {\n    state.busy = false;\n  }\n};\n\nexport const getProductBuyLink = (url, query = {}) => {\n  if (!state.selectedPrice?.id) return;\n  if (state.selectedPrice?.ad_hoc && !state.adHocAmount) return;\n\n  return addQueryArgs(url, {\n    line_items: [\n      {\n        price: state.selectedPrice?.id,\n        quantity: state.selectedPrice?.ad_hoc ? 1 : state.quantity,\n        ...(state.selectedPrice?.ad_hoc ? { ad_hoc_amount: state.adHocAmount } : {}),\n        ...(state.selectedVariant?.id ? { variant: state.selectedVariant?.id } : {}),\n      },\n    ],\n    ...query,\n  });\n};\n"]}