import{addLineItem}from"../../services/session";import state from"./store";import{getCheckout,setCheckout}from"@store/checkouts/mutations";import{toggleCart}from"@store/ui";import{addQueryArgs}from"@wordpress/url";export const submitCartForm=async()=>{var t,e,o,a,d,i;if(!(null===(t=state.selectedPrice)||void 0===t?void 0:t.id))return;if((null===(e=state.selectedPrice)||void 0===e?void 0:e.ad_hoc)&&(null===state.adHocAmount||void 0===state.adHocAmount))return;const s=getCheckout(null==state?void 0:state.formId,state.mode);try{state.busy=!0;const t=await addLineItem({checkout:s,data:{price:null===(o=state.selectedPrice)||void 0===o?void 0:o.id,quantity:Math.max((null===(a=state.selectedPrice)||void 0===a?void 0:a.ad_hoc)?1:state.quantity,1),variant:null===(d=state.selectedVariant)||void 0===d?void 0:d.id,...(null===(i=state.selectedPrice)||void 0===i?void 0:i.ad_hoc)?{ad_hoc_amount:state.adHocAmount}:{}},live_mode:"test"!==state.mode});setCheckout(t,state.formId),toggleCart(!0),state.dialog=null}catch(t){console.error(t),state.error=t}finally{state.busy=!1}};export const getProductBuyLink=(t,e={})=>{var o,a,d,i,s,r,c;if((null===(o=state.selectedPrice)||void 0===o?void 0:o.id)&&(!(null===(a=state.selectedPrice)||void 0===a?void 0:a.ad_hoc)||state.adHocAmount))return addQueryArgs(t,{line_items:[{price:null===(d=state.selectedPrice)||void 0===d?void 0:d.id,quantity:(null===(i=state.selectedPrice)||void 0===i?void 0:i.ad_hoc)?1:state.quantity,...(null===(s=state.selectedPrice)||void 0===s?void 0:s.ad_hoc)?{ad_hoc_amount:state.adHocAmount}:{},...(null===(r=state.selectedVariant)||void 0===r?void 0:r.id)?{variant:null===(c=state.selectedVariant)||void 0===c?void 0:c.id}:{}}],...e})};