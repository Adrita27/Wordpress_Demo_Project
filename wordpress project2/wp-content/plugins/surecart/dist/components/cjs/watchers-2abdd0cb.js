"use strict";const index=require("./index-00f0fc21.js"),util=require("./util-9c366e9f.js"),utils=require("./utils-45815a15.js"),index$1=require("./index-13ba9385.js"),productViewed=t=>{const e=new CustomEvent("scProductViewed",{detail:{id:null==t?void 0:t.id,name:null==t?void 0:t.name,permalink:null==t?void 0:t.permalink,prices:null==t?void 0:t.prices},bubbles:!0});document.dispatchEvent(e)};var _a$1,_b$1,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p;const product=(null===(_b$1=null===(_a$1=null===window||void 0===window?void 0:window.scData)||void 0===_a$1?void 0:_a$1.product_data)||void 0===_b$1?void 0:_b$1.product)||null,prices=(null===(_c=null==product?void 0:product.prices)||void 0===_c?void 0:_c.data)||[],variant_options=(null===(_d=null==product?void 0:product.variant_options)||void 0===_d?void 0:_d.data)||[],variants=((null===(_e=null==product?void 0:product.variants)||void 0===_e?void 0:_e.data)||[]).sort(((t,e)=>(null==t?void 0:t.position)-(null==e?void 0:e.position))),selectedPrice=(prices||[]).sort(((t,e)=>(null==t?void 0:t.position)-(null==e?void 0:e.position))).find((t=>!(null==t?void 0:t.archived))),selectedVariant=(null==variants?void 0:variants.length)?variants.find((t=>!((null==product?void 0:product.stock_enabled)&&!(null==product?void 0:product.allow_out_of_stock_purchases))||(null==t?void 0:t.available_stock)>0)):null,adHocAmount=(null==selectedPrice?void 0:selectedPrice.amount)||null;product&&productViewed(product);const store=index.createStore({formId:null===(_h=null===(_g=null===(_f=null===window||void 0===window?void 0:window.scData)||void 0===_f?void 0:_f.product_data)||void 0===_g?void 0:_g.form)||void 0===_h?void 0:_h.ID,mode:(null===(_k=null===(_j=null===window||void 0===window?void 0:window.scData)||void 0===_j?void 0:_j.product_data)||void 0===_k?void 0:_k.mode)||"live",product:product,prices:prices,variant_options:variant_options,variants:variants,quantity:1,selectedPrice:selectedPrice,total:null,dialog:null,busy:!1,disabled:(null==selectedPrice?void 0:selectedPrice.archived)||(null==product?void 0:product.archived),adHocAmount:adHocAmount,error:null,checkoutUrl:null===(_m=null===(_l=null===window||void 0===window?void 0:window.scData)||void 0===_l?void 0:_l.product_data)||void 0===_m?void 0:_m.checkout_link,line_item:{price_id:null==selectedPrice?void 0:selectedPrice.id,quantity:1,...(null==selectedPrice?void 0:selectedPrice.ad_hoc)?{ad_hoc_amount:adHocAmount}:{},variant:(null==variants?void 0:variants.length)?null===(_o=variants[0])||void 0===_o?void 0:_o.id:null},selectedVariant:selectedVariant,variantValues:{...(null==selectedVariant?void 0:selectedVariant.option_1)?{option_1:null==selectedVariant?void 0:selectedVariant.option_1}:{},...(null==selectedVariant?void 0:selectedVariant.option_2)?{option_2:null==selectedVariant?void 0:selectedVariant.option_2}:{},...(null==selectedVariant?void 0:selectedVariant.option_3)?{option_3:null==selectedVariant?void 0:selectedVariant.option_3}:{}}},((t,e)=>JSON.stringify(t)!==JSON.stringify(e))),{state:state,onChange:onChange,on:on,dispose:dispose,forceUpdate:forceUpdate}=store;var _a,_b;(null===(_p=null===window||void 0===window?void 0:window.sc)||void 0===_p?void 0:_p.store)&&(window.sc.store.product=store);const availablePrices=()=>(state.prices||[]).filter((t=>!(null==t?void 0:t.archived))).sort(((t,e)=>(null==t?void 0:t.position)-(null==e?void 0:e.position))),isStockNeedsToBeChecked=!(!(null===(_a=state.product)||void 0===_a?void 0:_a.stock_enabled)||(null===(_b=state.product)||void 0===_b?void 0:_b.allow_out_of_stock_purchases)),isOptionSoldOut=(t,e)=>utils.isProductVariantOptionSoldOut(t,e,state.variantValues,state.product),isOptionMissing=(t,e)=>utils.isProductVariantOptionMissing(t,e,state.variantValues,state.product),isProductOutOfStock=()=>{var t,e;return!!isStockNeedsToBeChecked&&((null==state?void 0:state.selectedVariant)?(null===(e=state.selectedVariant)||void 0===e?void 0:e.available_stock)<=0:(null===(t=state.product)||void 0===t?void 0:t.available_stock)<=0)},isSelectedVariantMissing=()=>{var t,e;return!!(null===(t=state.variants)||void 0===t?void 0:t.length)&&void 0===(null===(e=util.getVariantFromValues({variants:state.variants,values:state.variantValues}))||void 0===e?void 0:e.id)},getters=Object.freeze({__proto__:null,availablePrices:availablePrices,isStockNeedsToBeChecked:isStockNeedsToBeChecked,isOptionSoldOut:isOptionSoldOut,isOptionMissing:isOptionMissing,isProductOutOfStock:isProductOutOfStock,isSelectedVariantMissing:isSelectedVariantMissing});onChange("selectedPrice",(t=>{var e;state.total=state.adHocAmount||(null==t?void 0:t.amount)||0,state.adHocAmount=null==t?void 0:t.amount,state.disabled=(null==t?void 0:t.archived)||(null===(e=state.product)||void 0===e?void 0:e.archived)})),onChange("variantValues",(t=>{const e=util.getVariantFromValues({variants:state.variants,values:t});e&&(state.selectedVariant=e)})),onChange("selectedVariant",(()=>{state.selectedVariant&&isStockNeedsToBeChecked&&(null==state?void 0:state.selectedVariant.available_stock)<(null==state?void 0:state.quantity)&&(state.quantity=(null==state?void 0:state.selectedVariant.available_stock)||1,index$1.speak(wp.i18n.sprintf(wp.i18n.__("There are just %d items left in stock, and the quantity has been adjusted to %d.","surecart"),state.quantity,state.quantity),"assertive"))})),onChange("selectedPrice",(()=>setLineItem())),onChange("selectedVariant",(()=>setLineItem())),onChange("adHocAmount",(()=>setLineItem())),onChange("quantity",(()=>setLineItem()));const setLineItem=()=>{var t,e,i,o;state.line_item={price_id:null===(t=state.selectedPrice)||void 0===t?void 0:t.id,quantity:(null===(e=state.selectedPrice)||void 0===e?void 0:e.ad_hoc)?1:state.quantity,...(null===(i=state.selectedPrice)||void 0===i?void 0:i.ad_hoc)?{ad_hoc_amount:state.adHocAmount}:{},variant:null===(o=state.selectedVariant)||void 0===o?void 0:o.id}};exports.availablePrices=availablePrices,exports.dispose=dispose,exports.forceUpdate=forceUpdate,exports.getters=getters,exports.isOptionMissing=isOptionMissing,exports.isOptionSoldOut=isOptionSoldOut,exports.isProductOutOfStock=isProductOutOfStock,exports.isSelectedVariantMissing=isSelectedVariantMissing,exports.on=on,exports.onChange=onChange,exports.state=state;