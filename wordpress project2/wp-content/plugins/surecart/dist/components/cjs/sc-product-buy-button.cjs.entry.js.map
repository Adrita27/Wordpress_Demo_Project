{"file":"sc-product-buy-button.entry.cjs.js","mappings":";;;;;;;;;;;;;;;;;;;AAAA,MAAM,qBAAqB,GAAG,gxCAAgxC;;MCYjyC,kBAAkB;;;;;EAM7B,eAAe,CAAC,CAAC;;IACf,CAAC,CAAC,cAAc,EAAE,CAAC;;IAGnB,IAAIA,cAAK,CAAC,IAAI;MAAE,OAAO;;IAGvB,IAAI,MAAAA,cAAK,aAALA,cAAK,uBAALA,cAAK,CAAE,aAAa,0CAAE,MAAM,EAAE;MAChC,QAAQA,cAAK,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,GAAG,aAAa,GAAG,YAAY,EAAE;KACvE;;IAGD,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;MACnB,MAAM,WAAW,GAAG,MAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,0CAAE,KAAK,0CAAE,QAAQ,CAAC;MACpD,IAAI,CAAC,WAAW;QAAE,OAAO;MACzB,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAACC,2BAAiB,CAAC,WAAW,EAAE,EAAE,OAAO,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;KAC7F;;IAGDC,wBAAc,EAAE,CAAC;GAClB;EAGD,gBAAgB;IACd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;IACvC,IAAI,CAAC,iBAAiB,EAAE,CAAC;IACzBC,iBAAQ,CAAC,eAAe,EAAE,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC,CAAC;IAC1DA,iBAAQ,CAAC,iBAAiB,EAAE,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC,CAAC;GAC7D;EAED,iBAAiB;;IACf,MAAM,WAAW,GAAG,MAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM,0CAAE,KAAK,0CAAE,QAAQ,CAAC;IACpD,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,IAAI;MAAE,OAAO;IACvC,IAAI,CAAC,IAAI,CAAC,IAAI,GAAGF,2BAAiB,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,SAAS,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;GAC3F;EAED,MAAM;IACJ,QACEG,QAACC,UAAI,IACH,KAAK,EAAE;QACL,SAAS,EAAEL,cAAK,CAAC,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,SAAS;QACzC,aAAa,EAAEA,cAAK,CAAC,QAAQ;QAC7B,aAAa,EAAEM,4BAAmB,EAAE,IAAI,CAACC,iCAAwB,EAAE;QACnE,gBAAgB,EAAEA,iCAAwB,EAAE;OAC7C,EACD,OAAO,EAAE,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,IAErCH,qBAAQ,CACH,EACP;GACH;;;;;;;","names":["state","getProductBuyLink","submitCartForm","onChange","h","Host","isProductOutOfStock","isSelectedVariantMissing"],"sources":["./src/components/controllers/product/sc-product-buy-button/sc-product-buy-button.scss?tag=sc-product-buy-button","./src/components/controllers/product/sc-product-buy-button/sc-product-buy-button.tsx"],"sourcesContent":["sc-product-buy-button {\n  position: relative;\n\n  a.wp-block-button__link {\n    position: relative;\n    text-decoration: none;\n  }\n\n  .sc-block-button--sold-out,\n  .sc-block-button--unavailable {\n    display: none !important;\n  }\n\n  &.is-unavailable {\n    a {\n      display: none !important;\n    }\n    .sc-block-button--unavailable {\n      display: initial !important;\n    }\n  }\n\n  &.is-sold-out {\n    a {\n      display: none !important;\n    }\n    .sc-block-button--sold-out {\n      display: initial !important;\n    }\n  }\n\n  sc-spinner::part(base) {\n    --indicator-color: currentColor;\n    --spinner-size: 12px;\n    position: absolute;\n    top: calc(50% - var(--spinner-size) + (var(--spinner-size) / 4));\n    left: calc(50% - var(--spinner-size) + (var(--spinner-size) / 4));\n  }\n\n  [data-text],\n  [data-loader] {\n    transition: opacity var(--sc-transition-fast) ease-in-out, visibility var(--sc-transition-fast) ease-in-out;\n  }\n\n  [data-loader] {\n    opacity: 0;\n    visibility: hidden;\n  }\n\n  &.is-disabled {\n    pointer-events: none;\n  }\n\n  &.is-busy {\n    [data-text] {\n      opacity: 0;\n      visibility: hidden;\n    }\n    [data-loader] {\n      opacity: 1;\n      visibility: visible;\n    }\n  }\n\n  &.is-out-of-stock {\n    [data-text] {\n      opacity: 0.6;\n    }\n  }\n}\n","import { Component, Element, h, Host, Prop } from '@stencil/core';\nimport { state } from '@store/product';\nimport { __ } from '@wordpress/i18n';\nimport { onChange } from '@store/product';\nimport { isProductOutOfStock, isSelectedVariantMissing } from '@store/product/getters';\nimport { getProductBuyLink, submitCartForm } from '@store/product/mutations';\n\n@Component({\n  tag: 'sc-product-buy-button',\n  styleUrl: 'sc-product-buy-button.scss',\n  shadow: false,\n})\nexport class ScProductBuyButton {\n  @Element() el: HTMLScProductBuyButtonElement;\n\n  // Is add to cart enabled\n  @Prop() addToCart: boolean;\n\n  handleCartClick(e) {\n    e.preventDefault();\n\n    // already busy, do nothing.\n    if (state.busy) return;\n\n    // ad hoc price, use the dialog.\n    if (state?.selectedPrice?.ad_hoc) {\n      return (state.dialog = this.addToCart ? 'ad_hoc_cart' : 'ad_hoc_buy');\n    }\n\n    // if add to cart is undefined/false navigate to buy url\n    if (!this.addToCart) {\n      const checkoutUrl = window?.scData?.pages?.checkout;\n      if (!checkoutUrl) return;\n      return window.location.assign(getProductBuyLink(checkoutUrl, { no_cart: !this.addToCart }));\n    }\n\n    // submit the cart form.\n    submitCartForm();\n  }\n\n  private link: HTMLAnchorElement;\n  componentDidLoad() {\n    this.link = this.el.querySelector('a');\n    this.updateProductLink();\n    onChange('selectedPrice', () => this.updateProductLink());\n    onChange('selectedVariant', () => this.updateProductLink());\n  }\n\n  updateProductLink() {\n    const checkoutUrl = window?.scData?.pages?.checkout;\n    if (!checkoutUrl || !this.link) return;\n    this.link.href = getProductBuyLink(checkoutUrl, !this.addToCart ? { no_cart: true } : {});\n  }\n\n  render() {\n    return (\n      <Host\n        class={{\n          'is-busy': state.busy && !!this.addToCart,\n          'is-disabled': state.disabled,\n          'is-sold-out': isProductOutOfStock() && !isSelectedVariantMissing(),\n          'is-unavailable': isSelectedVariantMissing(),\n        }}\n        onClick={e => this.handleCartClick(e)}\n      >\n        <slot />\n      </Host>\n    );\n  }\n}\n"],"version":3}